{"version":3,"file":"MatrixConfigurator.js","mappings":"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","sources":["webpack:///./MatrixConfigurator.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  /**\n   * Matrix configurator class\n   */\n  Craft.MatrixConfigurator = Garnish.Base.extend({\n    fieldTypeInfo: null,\n\n    inputNamePrefix: null,\n    fieldTypeSettingsNamespace: null,\n    inputIdPrefix: null,\n    placeholderKey: null,\n\n    $container: null,\n\n    $blockTypesColumnContainer: null,\n    $fieldsColumnContainer: null,\n    $fieldSettingsColumnContainer: null,\n\n    $blockTypeItemsOuterContainer: null,\n    $blockTypeItemsContainer: null,\n    $fieldItemsContainer: null,\n    $fieldSettingItemsContainer: null,\n\n    $newBlockTypeBtn: null,\n    $newFieldBtn: null,\n\n    blockTypes: null,\n    selectedBlockType: null,\n    blockTypeSort: null,\n    totalNewBlockTypes: 0,\n\n    _fieldTypeSettingsHtml: null,\n    _cancelToken: null,\n    _ignoreFailedRequest: false,\n\n    init: function (\n      fieldTypeInfo,\n      inputNamePrefix,\n      fieldTypeSettingsNamespace,\n      placeholderKey\n    ) {\n      this.fieldTypeInfo = fieldTypeInfo;\n      this.inputNamePrefix = inputNamePrefix;\n      this.fieldTypeSettingsNamespace = fieldTypeSettingsNamespace;\n      this.inputIdPrefix = Craft.formatInputId(this.inputNamePrefix);\n      this.placeholderKey = placeholderKey;\n\n      this.$container = $(\n        '#' + this.inputIdPrefix + '-matrix-configurator:first .input:first'\n      );\n\n      this.$blockTypesColumnContainer = this.$container\n        .children('.block-types')\n        .children();\n      this.$fieldsColumnContainer = this.$container\n        .children('.mc-fields')\n        .children();\n      this.$fieldSettingsColumnContainer = this.$container\n        .children('.mc-field-settings')\n        .children();\n\n      this.$blockTypeItemsOuterContainer =\n        this.$blockTypesColumnContainer.children('.mc-col-items');\n      this.$blockTypeItemsContainer =\n        this.$blockTypeItemsOuterContainer.children('.mc-blocktypes');\n      this.$fieldItemsOuterContainer =\n        this.$fieldsColumnContainer.children('.mc-col-items');\n      this.$fieldSettingItemsContainer =\n        this.$fieldSettingsColumnContainer.children('.mc-col-items');\n\n      this.$newBlockTypeBtn =\n        this.$blockTypeItemsOuterContainer.children('.btn');\n      this.$newFieldBtn = this.$fieldItemsOuterContainer.children('.btn');\n\n      this._fieldTypeSettingsHtml = {};\n\n      // Find the existing block types\n      this.blockTypes = {};\n\n      var $blockTypeItems = this.$blockTypeItemsContainer.children();\n\n      for (var i = 0; i < $blockTypeItems.length; i++) {\n        var $item = $($blockTypeItems[i]),\n          id = $item.data('id');\n\n        this.blockTypes[id] = new BlockType(this, $item);\n\n        // Is this a new block type?\n        var newMatch = typeof id === 'string' && id.match(/new(\\d+)/);\n\n        if (newMatch && newMatch[1] > this.totalNewBlockTypes) {\n          this.totalNewBlockTypes = parseInt(newMatch[1]);\n        }\n      }\n\n      this.blockTypeSort = new Garnish.DragSort($blockTypeItems, {\n        handle: '.move',\n        axis: 'y',\n      });\n\n      this.addListener(this.$newBlockTypeBtn, 'click', 'addBlockType');\n      this.addListener(\n        this.$newFieldBtn,\n        'click',\n        'addFieldToSelectedBlockType'\n      );\n    },\n\n    getFieldTypeInfo: function (type) {\n      for (var i = 0; i < this.fieldTypeInfo.length; i++) {\n        if (this.fieldTypeInfo[i].type === type) {\n          return this.fieldTypeInfo[i];\n        }\n      }\n    },\n\n    addBlockType: function () {\n      this.getBlockTypeSettingsModal();\n\n      this.blockTypeSettingsModal.show();\n\n      this.blockTypeSettingsModal.onSubmit = (name, handle) => {\n        this.totalNewBlockTypes++;\n        var id = 'new' + this.totalNewBlockTypes;\n\n        var $item = $(\n          '<div class=\"matrixconfigitem mci-blocktype\" data-id=\"' +\n            id +\n            '\">' +\n            '<div class=\"mci-name\">' +\n            '<h4></h4>' +\n            '<div class=\"smalltext light code\"></div>' +\n            '</div>' +\n            '<a class=\"settings icon\" title=\"' +\n            Craft.t('app', 'Settings') +\n            '\"></a>' +\n            '<a class=\"move icon\" title=\"' +\n            Craft.t('app', 'Reorder') +\n            '\"></a>' +\n            '<input class=\"hidden\" name=\"' +\n            this.inputNamePrefix +\n            '[blockTypes][' +\n            id +\n            '][name]\">' +\n            '<input class=\"hidden\" name=\"' +\n            this.inputNamePrefix +\n            '[blockTypes][' +\n            id +\n            '][handle]\">' +\n            '</div>'\n        ).appendTo(this.$blockTypeItemsContainer);\n\n        this.blockTypes[id] = new BlockType(this, $item);\n        this.blockTypes[id].applySettings(name, handle);\n        this.blockTypes[id].select();\n        this.blockTypes[id].addField();\n\n        this.blockTypeSort.addItems($item);\n      };\n    },\n\n    addFieldToSelectedBlockType: function () {\n      if (this.selectedBlockType) {\n        this.selectedBlockType.addField();\n      }\n    },\n\n    getBlockTypeSettingsModal: function () {\n      if (!this.blockTypeSettingsModal) {\n        this.blockTypeSettingsModal = new BlockTypeSettingsModal();\n      }\n\n      return this.blockTypeSettingsModal;\n    },\n\n    getFieldTypeSettingsHtml: function (type) {\n      return new Promise((resolve, reject) => {\n        if (typeof this._fieldTypeSettingsHtml[type] !== 'undefined') {\n          resolve(this._fieldTypeSettingsHtml[type]);\n          return;\n        }\n\n        // Cancel the current request\n        if (this._cancelToken) {\n          this._ignoreFailedRequest = true;\n          this._cancelToken.cancel();\n          Garnish.requestAnimationFrame(() => {\n            this._ignoreFailedRequest = false;\n          });\n        }\n\n        // Create a cancel token\n        this._cancelToken = axios.CancelToken.source();\n\n        Craft.sendActionRequest('POST', 'fields/render-settings', {\n          cancelToken: this._cancelToken.token,\n          data: {\n            type: type,\n            namespace: this.fieldTypeSettingsNamespace,\n          },\n        })\n          .then((response) => {\n            this._fieldTypeSettingsHtml[type] = response.data;\n            resolve(response.data);\n          })\n          .catch((e) => {\n            if (!this._ignoreFailedRequest) {\n              Craft.cp.displayError(e?.response?.data?.message);\n            }\n            reject();\n          });\n      });\n    },\n  });\n\n  /**\n   * Block type settings modal class\n   */\n  var BlockTypeSettingsModal = Garnish.Modal.extend({\n    init: function () {\n      this.base();\n\n      this.$form = $('<form class=\"modal fitted\"/>').appendTo(Garnish.$bod);\n      this.setContainer(this.$form);\n\n      this.$body = $('<div class=\"body\"/>').appendTo(this.$form);\n      let $nameField = Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Name'),\n          instructions: Craft.t(\n            'app',\n            'What this block type will be called in the control panel.'\n          ),\n        })\n        .appendTo(this.$body);\n      let $nameInputContainer = $nameField.find('.input');\n      this.$nameInput = $nameInputContainer.find('.text');\n      this.$nameErrorList = $('<ul class=\"errors\"/>')\n        .appendTo($nameInputContainer)\n        .hide();\n      let $handleField = Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Handle'),\n          instructions: Craft.t(\n            'app',\n            'How you’ll refer to this block type in the templates.'\n          ),\n          class: 'code',\n          maxlength: 47,\n        })\n        .appendTo(this.$body);\n      let $handleInputContainer = $handleField.find('.input');\n      this.$handleInput = $handleInputContainer.find('.text');\n      this.$handleErrorList = $('<ul class=\"errors\"/>')\n        .appendTo($handleInputContainer)\n        .hide();\n      this.$deleteBtn = $(\n        '<a class=\"error left hidden\" style=\"line-height: 30px;\">' +\n          Craft.t('app', 'Delete') +\n          '</a>'\n      ).appendTo(this.$body);\n      this.$buttons = $(\n        '<div class=\"buttons right\" style=\"margin-top: 0;\"/>'\n      ).appendTo(this.$body);\n      this.$cancelBtn = $('<button/>', {\n        type: 'button',\n        class: 'btn',\n        text: Craft.t('app', 'Cancel'),\n      }).appendTo(this.$buttons);\n      this.$submitBtn = $('<button/>', {\n        type: 'submit',\n        class: 'btn submit',\n      }).appendTo(this.$buttons);\n\n      this.handleGenerator = new Craft.HandleGenerator(\n        this.$nameInput,\n        this.$handleInput\n      );\n\n      this.addListener(this.$cancelBtn, 'click', 'hide');\n      this.addListener(this.$form, 'submit', 'onFormSubmit');\n      this.addListener(this.$deleteBtn, 'click', 'onDeleteClick');\n    },\n\n    onFormSubmit: function (ev) {\n      ev.preventDefault();\n\n      // Prevent multi form submits with the return key\n      if (!this.visible) {\n        return;\n      }\n\n      if (this.handleGenerator.listening) {\n        // Give the handle a chance to catch up with the input\n        this.handleGenerator.updateTarget();\n      }\n\n      // Basic validation\n      const name = this.$nameInput.val().trim();\n      const handle = this.$handleInput.val().trim();\n\n      if (!name || !handle) {\n        Garnish.shake(this.$form);\n      } else {\n        this.hide();\n        this.onSubmit(name, handle);\n      }\n    },\n\n    onDeleteClick: function () {\n      if (\n        confirm(\n          Craft.t('app', 'Are you sure you want to delete this block type?')\n        )\n      ) {\n        this.hide();\n        this.onDelete();\n      }\n    },\n\n    show: function (name, handle, errors) {\n      this.$nameInput.val(typeof name === 'string' ? name : '');\n      this.$handleInput.val(typeof handle === 'string' ? handle : '');\n\n      if (!handle) {\n        this.handleGenerator.startListening();\n      } else {\n        this.handleGenerator.stopListening();\n      }\n\n      if (typeof name === 'undefined') {\n        this.$deleteBtn.addClass('hidden');\n        this.$submitBtn.text(Craft.t('app', 'Create'));\n      } else {\n        this.$deleteBtn.removeClass('hidden');\n        this.$submitBtn.text(Craft.t('app', 'Apply'));\n      }\n\n      this.displayErrors('name', errors ? errors.name : null);\n      this.displayErrors('handle', errors ? errors.handle : null);\n\n      if (!Garnish.isMobileBrowser()) {\n        setTimeout(() => {\n          this.$nameInput.focus();\n        }, 100);\n      }\n\n      this.base();\n    },\n\n    displayErrors: function (attr, errors) {\n      var $input = this['$' + attr + 'Input'],\n        $errorList = this['$' + attr + 'ErrorList'];\n\n      $errorList.children().remove();\n\n      if (errors) {\n        $input.addClass('error');\n        $errorList.show();\n\n        for (var i = 0; i < errors.length; i++) {\n          $('<li/>').text(errors[i]).appendTo($errorList);\n        }\n      } else {\n        $input.removeClass('error');\n        $errorList.hide();\n      }\n    },\n  });\n\n  /**\n   * Block type class\n   */\n  var BlockType = Garnish.Base.extend({\n    configurator: null,\n    id: null,\n    errors: null,\n\n    inputNamePrefix: null,\n    inputIdPrefix: null,\n\n    $item: null,\n    $nameLabel: null,\n    $handleLabel: null,\n    $nameHiddenInput: null,\n    $handleHiddenInput: null,\n    $settingsBtn: null,\n    $fieldItemsContainer: null,\n    $fieldSettingsContainer: null,\n\n    fields: null,\n    selectedField: null,\n    fieldSort: null,\n    totalNewFields: 0,\n    fieldSettings: null,\n\n    init: function (configurator, $item) {\n      this.configurator = configurator;\n      this.$item = $item;\n      this.id = this.$item.data('id');\n      this.errors = this.$item.data('errors');\n\n      this.inputNamePrefix =\n        this.configurator.inputNamePrefix + '[blockTypes][' + this.id + ']';\n      this.inputIdPrefix =\n        this.configurator.inputIdPrefix + '-blockTypes-' + this.id;\n\n      let $nameContainer = this.$item.children('.mci-name');\n      this.$nameLabel = $nameContainer.children('h4');\n      this.$handleLabel = $nameContainer.children('.smalltext');\n      this.$nameHiddenInput = this.$item.find('input[name$=\"[name]\"]:first');\n      this.$handleHiddenInput = this.$item.find(\n        'input[name$=\"[handle]\"]:first'\n      );\n      this.$settingsBtn = this.$item.find('.settings');\n\n      // Find the field items container if it exists, otherwise create it\n      this.$fieldItemsContainer =\n        this.configurator.$fieldItemsOuterContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      if (!this.$fieldItemsContainer.length) {\n        this.$fieldItemsContainer = $(\n          '<div data-id=\"' + this.id + '\"/>'\n        ).insertBefore(this.configurator.$newFieldBtn);\n      }\n\n      // Find the field settings container if it exists, otherwise create it\n      this.$fieldSettingsContainer =\n        this.configurator.$fieldSettingItemsContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      if (!this.$fieldSettingsContainer.length) {\n        this.$fieldSettingsContainer = $(\n          '<div data-id=\"' + this.id + '\"/>'\n        ).appendTo(this.configurator.$fieldSettingItemsContainer);\n      }\n\n      // Find the existing fields\n      this.fields = {};\n\n      var $fieldItems = this.$fieldItemsContainer.children();\n\n      for (var i = 0; i < $fieldItems.length; i++) {\n        var $fieldItem = $($fieldItems[i]),\n          id = $fieldItem.data('id');\n\n        this.fields[id] = new Field(this.configurator, this, $fieldItem);\n\n        // Is this a new field?\n        var newMatch = typeof id === 'string' && id.match(/new(\\d+)/);\n\n        if (newMatch && newMatch[1] > this.totalNewFields) {\n          this.totalNewFields = parseInt(newMatch[1]);\n        }\n      }\n\n      this.addListener(this.$item, 'click', 'select');\n      this.addListener(this.$settingsBtn, 'click', 'showSettings');\n\n      this.fieldSort = new Garnish.DragSort($fieldItems, {\n        handle: '.move',\n        axis: 'y',\n        onSortChange: () => {\n          // Adjust the field setting containers to match the new sort order\n          for (var i = 0; i < this.fieldSort.$items.length; i++) {\n            var $item = $(this.fieldSort.$items[i]),\n              id = $item.data('id'),\n              field = this.fields[id];\n\n            field.$fieldSettingsContainer.appendTo(\n              this.$fieldSettingsContainer\n            );\n          }\n        },\n      });\n    },\n\n    select: function () {\n      if (this.configurator.selectedBlockType === this) {\n        return;\n      }\n\n      if (this.configurator.selectedBlockType) {\n        this.configurator.selectedBlockType.deselect();\n      }\n\n      this.configurator.$fieldsColumnContainer.removeClass('hidden');\n      this.$fieldItemsContainer.removeClass('hidden');\n      this.$item.addClass('sel');\n      this.configurator.selectedBlockType = this;\n      Garnish.$win.trigger('resize');\n    },\n\n    deselect: function () {\n      this.$item.removeClass('sel');\n      this.configurator.$fieldsColumnContainer.addClass('hidden');\n      this.$fieldItemsContainer.addClass('hidden');\n      this.$fieldSettingsContainer.addClass('hidden');\n      this.configurator.selectedBlockType = null;\n\n      if (this.selectedField) {\n        this.selectedField.deselect();\n      }\n\n      Garnish.$win.trigger('resize');\n    },\n\n    showSettings: function () {\n      var blockTypeSettingsModal =\n        this.configurator.getBlockTypeSettingsModal();\n      blockTypeSettingsModal.show(\n        this.$nameHiddenInput.val(),\n        this.$handleHiddenInput.val(),\n        this.errors\n      );\n      blockTypeSettingsModal.onSubmit = this.applySettings.bind(this);\n      blockTypeSettingsModal.onDelete = this.selfDestruct.bind(this);\n    },\n\n    applySettings: function (name, handle) {\n      if (this.errors) {\n        this.errors = null;\n        this.$settingsBtn.removeClass('error');\n      }\n\n      this.$nameLabel.attr('title', name).text(name);\n      this.$handleLabel.attr('title', handle).text(handle);\n      this.$nameHiddenInput.val(name);\n      this.$handleHiddenInput.val(handle);\n    },\n\n    addField: function () {\n      this.totalNewFields++;\n      var id = 'new' + this.totalNewFields;\n\n      var $item = $(\n        '<div class=\"matrixconfigitem mci-field\" data-id=\"' +\n          id +\n          '\">' +\n          '<div class=\"mci-name\">' +\n          '<h4><em class=\"light\">' +\n          Craft.t('app', '(blank)') +\n          '</em></h4>' +\n          '<div class=\"smalltext light code\"></div>' +\n          '</div>' +\n          '<div class=\"actions\">' +\n          '<a class=\"move icon\" title=\"' +\n          Craft.t('app', 'Reorder') +\n          '\"></a>' +\n          '</div>' +\n          '</div>'\n      ).appendTo(this.$fieldItemsContainer);\n\n      this.fields[id] = new Field(this.configurator, this, $item);\n      this.fields[id].select();\n\n      this.fieldSort.addItems($item);\n    },\n\n    selfDestruct: function () {\n      this.deselect();\n      this.$item.remove();\n      this.$fieldItemsContainer.remove();\n      this.$fieldSettingsContainer.remove();\n\n      this.configurator.blockTypes[this.id] = null;\n      delete this.configurator.blockTypes[this.id];\n    },\n  });\n\n  var Field = Garnish.Base.extend({\n    configurator: null,\n    blockType: null,\n    id: null,\n\n    inputNamePrefix: null,\n    inputIdPrefix: null,\n\n    selectedFieldType: null,\n    initializedFieldTypeSettings: null,\n\n    $item: null,\n    $nameLabel: null,\n    $handleLabel: null,\n\n    $fieldSettingsContainer: null,\n    $nameInput: null,\n    $handleInput: null,\n    $requiredCheckbox: null,\n    $typeSelect: null,\n    $translationSettingsContainer: null,\n    $typeSettingsContainer: null,\n    $widthInput: null,\n    $deleteBtn: null,\n\n    init: function (configurator, blockType, $item) {\n      this.configurator = configurator;\n      this.blockType = blockType;\n      this.$item = $item;\n      this.id = this.$item.data('id');\n\n      this.inputNamePrefix =\n        this.blockType.inputNamePrefix + '[fields][' + this.id + ']';\n      this.inputIdPrefix = this.blockType.inputIdPrefix + '-fields-' + this.id;\n\n      this.initializedFieldTypeSettings = {};\n      this.fieldTypeSettingsTemplates = {};\n\n      let $nameContainer = this.$item.children('.mci-name');\n      this.$nameLabel = $nameContainer.children('h4');\n      this.$handleLabel = $nameContainer.children('.smalltext');\n\n      // Find the field settings container if it exists, otherwise create it\n      this.$fieldSettingsContainer =\n        this.blockType.$fieldSettingsContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      var isNew = !this.$fieldSettingsContainer.length;\n\n      if (isNew) {\n        this.$fieldSettingsContainer = this.getDefaultFieldSettings().appendTo(\n          this.blockType.$fieldSettingsContainer\n        );\n      }\n\n      this.$nameInput = $('#' + this.inputIdPrefix + '-name');\n      this.$handleInput = $('#' + this.inputIdPrefix + '-handle');\n      this.$requiredCheckbox = $('#' + this.inputIdPrefix + '-required');\n      this.$typeSelect = $('#' + this.inputIdPrefix + '-type');\n      this.$translationSettingsContainer = $(\n        '#' + this.inputIdPrefix + '-translation-settings'\n      );\n      this.$typeSettingsContainer = this.$fieldSettingsContainer.children(\n        '.mc-fieldtype-settings:first'\n      );\n      this.$widthInput = $('#' + this.inputIdPrefix + '-width');\n      this.$deleteBtn = this.$fieldSettingsContainer.children('a.delete:first');\n\n      if (isNew) {\n        this.setFieldType('craft\\\\fields\\\\PlainText');\n      } else {\n        this.selectedFieldType = this.$typeSelect.val();\n        this.initializedFieldTypeSettings[this.selectedFieldType] =\n          this.$typeSettingsContainer.children();\n      }\n\n      if (!this.$handleInput.val()) {\n        new Craft.HandleGenerator(this.$nameInput, this.$handleInput);\n      }\n\n      this.addListener(this.$item, 'click', 'select');\n      this.addListener(this.$nameInput, 'input', 'updateNameLabel');\n      this.addListener(this.$handleInput, 'input', 'updateHandleLabel');\n      this.addListener(this.$requiredCheckbox, 'change', 'updateRequiredIcon');\n      this.addListener(this.$typeSelect, 'change', 'onTypeSelectChange');\n      this.addListener(this.$deleteBtn, 'click', 'confirmDelete');\n\n      let widthSlider = new Craft.SlidePicker(this.$widthInput.val() || 100, {\n        min: 25,\n        max: 100,\n        step: 25,\n        valueLabel: (width) => {\n          return Craft.t('app', '{pct} width', {pct: `${width}%`});\n        },\n        onChange: (width) => {\n          this.$widthInput.val(width);\n        },\n      });\n      widthSlider.$container.insertAfter($nameContainer);\n    },\n\n    select: function () {\n      if (this.blockType.selectedField === this) {\n        return;\n      }\n\n      if (this.blockType.selectedField) {\n        this.blockType.selectedField.deselect();\n      }\n\n      this.configurator.$fieldSettingsColumnContainer.removeClass('hidden');\n      this.blockType.$fieldSettingsContainer.removeClass('hidden');\n      this.$fieldSettingsContainer.removeClass('hidden');\n      this.$item.addClass('sel');\n      this.blockType.selectedField = this;\n      Garnish.$win.trigger('resize');\n\n      if (!Garnish.isMobileBrowser()) {\n        setTimeout(() => {\n          this.$nameInput.focus();\n        }, 100);\n      }\n    },\n\n    deselect: function () {\n      this.$item.removeClass('sel');\n      this.configurator.$fieldSettingsColumnContainer.addClass('hidden');\n      this.blockType.$fieldSettingsContainer.addClass('hidden');\n      this.$fieldSettingsContainer.addClass('hidden');\n      this.blockType.selectedField = null;\n      Garnish.$win.trigger('resize');\n    },\n\n    updateNameLabel: function () {\n      const name = this.$nameInput.val();\n      this.$nameLabel\n        .attr('title', name)\n        .html(\n          name\n            ? Craft.escapeHtml(name)\n            : '<em class=\"light\">' + Craft.t('app', '(blank)') + '</em>'\n        );\n    },\n\n    updateHandleLabel: function () {\n      const handle = this.$handleInput.val();\n      this.$handleLabel.attr('title', handle).html(Craft.escapeHtml(handle));\n    },\n\n    updateRequiredIcon: function () {\n      if (this.$requiredCheckbox.prop('checked')) {\n        this.$nameLabel.addClass('mci-required');\n      } else {\n        this.$nameLabel.removeClass('mci-required');\n      }\n    },\n\n    onTypeSelectChange: function () {\n      this.setFieldType(this.$typeSelect.val());\n    },\n\n    setFieldType: function (type) {\n      // Update the Translation Method settings\n      Craft.updateTranslationMethodSettings(\n        type,\n        this.$translationSettingsContainer\n      );\n\n      if (this.selectedFieldType) {\n        this.initializedFieldTypeSettings[this.selectedFieldType].detach();\n      }\n\n      this.selectedFieldType = type;\n      this.$typeSelect.val(type);\n\n      // Show a spinner\n      this.$typeSettingsContainer.html(\n        '<div class=\"zilch\"><div class=\"spinner\"></div></div>'\n      );\n\n      this.getFieldTypeSettings(type)\n        .then(({fresh, $settings, headHtml, bodyHtml}) => {\n          this.$typeSettingsContainer.html('').append($settings);\n          if (fresh) {\n            Craft.initUiElements($settings);\n            Craft.appendHeadHtml(headHtml);\n            Craft.appendBodyHtml(bodyHtml);\n          }\n\n          Garnish.$win.trigger('resize');\n        })\n        .catch(() => {\n          this.$typeSettingsContainer.html('');\n        });\n    },\n\n    getFieldTypeSettings: function (type) {\n      return new Promise((resolve, reject) => {\n        if (typeof this.initializedFieldTypeSettings[type] !== 'undefined') {\n          resolve({\n            fresh: false,\n            $settings: this.initializedFieldTypeSettings[type],\n          });\n          return;\n        }\n\n        this.configurator\n          .getFieldTypeSettingsHtml(type)\n          .then(({settingsHtml, headHtml, bodyHtml}) => {\n            settingsHtml = this.getParsedFieldTypeHtml(settingsHtml);\n            headHtml = this.getParsedFieldTypeHtml(headHtml);\n            bodyHtml = this.getParsedFieldTypeHtml(bodyHtml);\n            let $settings = $('<div/>').html(settingsHtml);\n            this.initializedFieldTypeSettings[type] = $settings;\n            resolve({\n              fresh: true,\n              $settings: $settings,\n              headHtml: headHtml,\n              bodyHtml: bodyHtml,\n            });\n          })\n          .catch($.noop);\n      });\n    },\n\n    getParsedFieldTypeHtml: function (html) {\n      if (typeof html === 'string') {\n        html = html.replace(\n          new RegExp(`__BLOCK_TYPE_${this.configurator.placeholderKey}__`, 'g'),\n          this.blockType.id\n        );\n        html = html.replace(\n          new RegExp(`__FIELD_${this.configurator.placeholderKey}__`, 'g'),\n          this.id\n        );\n      } else {\n        html = '';\n      }\n\n      return html;\n    },\n\n    getDefaultFieldSettings: function () {\n      var $container = $('<div/>', {\n        'data-id': this.id,\n      });\n\n      Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Name'),\n          id: this.inputIdPrefix + '-name',\n          name: this.inputNamePrefix + '[name]',\n        })\n        .appendTo($container);\n\n      Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Handle'),\n          id: this.inputIdPrefix + '-handle',\n          class: 'code',\n          name: this.inputNamePrefix + '[handle]',\n          maxlength: 64,\n          required: true,\n        })\n        .appendTo($container);\n\n      Craft.ui\n        .createTextareaField({\n          label: Craft.t('app', 'Instructions'),\n          id: this.inputIdPrefix + '-instructions',\n          class: 'nicetext',\n          name: this.inputNamePrefix + '[instructions]',\n        })\n        .appendTo($container);\n\n      let $fieldset = $('<fieldset/>').appendTo($container);\n\n      Craft.ui\n        .createCheckboxField({\n          label: Craft.t('app', 'This field is required'),\n          id: this.inputIdPrefix + '-required',\n          name: this.inputNamePrefix + '[required]',\n        })\n        .appendTo($fieldset);\n\n      Craft.ui\n        .createCheckboxField({\n          label: Craft.t('app', 'Use this field’s values as search keywords'),\n          id: this.inputIdPrefix + '-searchable',\n          name: this.inputNamePrefix + '[searchable]',\n          checked: false,\n        })\n        .appendTo($fieldset);\n\n      var fieldTypeOptions = [];\n\n      for (var i = 0; i < this.configurator.fieldTypeInfo.length; i++) {\n        fieldTypeOptions.push({\n          value: this.configurator.fieldTypeInfo[i].type,\n          label: this.configurator.fieldTypeInfo[i].name,\n        });\n      }\n\n      Craft.ui\n        .createSelectField({\n          label: Craft.t('app', 'Field Type'),\n          id: this.inputIdPrefix + '-type',\n          name: this.inputNamePrefix + '[type]',\n          options: fieldTypeOptions,\n          value: 'craft\\\\fields\\\\PlainText',\n        })\n        .appendTo($container);\n\n      if (Craft.isMultiSite) {\n        var $translationSettingsContainer = $('<div/>', {\n          id: this.inputIdPrefix + '-translation-settings',\n        }).appendTo($container);\n\n        Craft.ui\n          .createSelectField({\n            label: Craft.t('app', 'Translation Method'),\n            id: this.inputIdPrefix + '-translation-method',\n            name: this.inputNamePrefix + '[translationMethod]',\n            options: [],\n            value: 'none',\n            toggle: true,\n            targetPrefix: this.inputIdPrefix + '-translation-method-',\n          })\n          .appendTo($translationSettingsContainer);\n\n        var $translationKeyFormatContainer = $('<div/>', {\n          id: this.inputIdPrefix + '-translation-method-custom',\n          class: 'hidden',\n        }).appendTo($translationSettingsContainer);\n\n        Craft.ui\n          .createTextField({\n            label: Craft.t('app', 'Translation Key Format'),\n            id: this.inputIdPrefix + '-translation-key-format',\n            name: this.inputNamePrefix + '[translationKeyFormat]',\n          })\n          .appendTo($translationKeyFormatContainer);\n      }\n\n      $('<hr/>').appendTo($container);\n\n      $('<div/>', {\n        class: 'mc-fieldtype-settings',\n      }).appendTo($container);\n\n      $('<input/>', {\n        type: 'hidden',\n        id: this.inputIdPrefix + '-width',\n        name: this.inputNamePrefix + '[width]',\n        value: '100',\n      }).appendTo($container);\n\n      $('<hr/>').appendTo($container);\n\n      $('<a/>', {\n        class: 'error delete',\n        text: Craft.t('app', 'Delete'),\n      }).appendTo($container);\n\n      return $container;\n    },\n\n    confirmDelete: function () {\n      if (\n        confirm(Craft.t('app', 'Are you sure you want to delete this field?'))\n      ) {\n        this.selfDestruct();\n      }\n    },\n\n    selfDestruct: function () {\n      this.deselect();\n      this.$item.remove();\n      this.$fieldSettingsContainer.remove();\n\n      this.blockType.fields[this.id] = null;\n      delete this.blockType.fields[this.id];\n    },\n  });\n})(jQuery);\n"],"names":["$","Craft","MatrixConfigurator","Garnish","Base","extend","fieldTypeInfo","inputNamePrefix","fieldTypeSettingsNamespace","inputIdPrefix","placeholderKey","$container","$blockTypesColumnContainer","$fieldsColumnContainer","$fieldSettingsColumnContainer","$blockTypeItemsOuterContainer","$blockTypeItemsContainer","$fieldItemsContainer","$fieldSettingItemsContainer","$newBlockTypeBtn","$newFieldBtn","blockTypes","selectedBlockType","blockTypeSort","totalNewBlockTypes","_fieldTypeSettingsHtml","_cancelToken","_ignoreFailedRequest","init","this","formatInputId","children","$fieldItemsOuterContainer","$blockTypeItems","i","length","$item","id","data","BlockType","newMatch","match","parseInt","DragSort","handle","axis","addListener","getFieldTypeInfo","type","addBlockType","getBlockTypeSettingsModal","blockTypeSettingsModal","show","onSubmit","name","t","appendTo","applySettings","select","addField","addItems","addFieldToSelectedBlockType","BlockTypeSettingsModal","getFieldTypeSettingsHtml","Promise","resolve","reject","cancel","requestAnimationFrame","axios","CancelToken","source","sendActionRequest","cancelToken","token","namespace","then","response","e","cp","displayError","message","Modal","base","$form","$bod","setContainer","$body","$nameInputContainer","ui","createTextField","label","instructions","find","$nameInput","$nameErrorList","hide","$handleInputContainer","class","maxlength","$handleInput","$handleErrorList","$deleteBtn","$buttons","$cancelBtn","text","$submitBtn","handleGenerator","HandleGenerator","onFormSubmit","ev","preventDefault","visible","listening","updateTarget","val","trim","shake","onDeleteClick","confirm","onDelete","errors","stopListening","startListening","addClass","removeClass","displayErrors","isMobileBrowser","setTimeout","focus","attr","$input","$errorList","remove","configurator","$nameLabel","$handleLabel","$nameHiddenInput","$handleHiddenInput","$settingsBtn","$fieldSettingsContainer","fields","selectedField","fieldSort","totalNewFields","fieldSettings","$nameContainer","insertBefore","$fieldItems","$fieldItem","Field","onSortChange","$items","deselect","$win","trigger","showSettings","bind","selfDestruct","blockType","selectedFieldType","initializedFieldTypeSettings","$requiredCheckbox","$typeSelect","$translationSettingsContainer","$typeSettingsContainer","$widthInput","fieldTypeSettingsTemplates","isNew","getDefaultFieldSettings","setFieldType","SlidePicker","min","max","step","valueLabel","width","pct","onChange","insertAfter","updateNameLabel","html","escapeHtml","updateHandleLabel","updateRequiredIcon","prop","onTypeSelectChange","updateTranslationMethodSettings","detach","getFieldTypeSettings","fresh","$settings","headHtml","bodyHtml","append","initUiElements","appendHeadHtml","appendBodyHtml","settingsHtml","getParsedFieldTypeHtml","noop","replace","RegExp","required","createTextareaField","$fieldset","createCheckboxField","checked","fieldTypeOptions","push","value","createSelectField","options","isMultiSite","toggle","targetPrefix","$translationKeyFormatContainer","confirmDelete","jQuery"],"sourceRoot":""}
!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/",__webpack_require__(__webpack_require__.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _dashboard_src_dashboard_scss__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_dashboard_src_dashboard_scss__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_dashboard_src_dashboard_scss__WEBPACK_IMPORTED_MODULE_0__);!function($){Craft.Dashboard=Garnish.Base.extend({$grid:null,$widgetManagerBtn:null,widgetTypes:null,grid:null,widgets:null,widgetManager:null,widgetAdminTable:null,widgetSettingsModal:null,init:function(widgetTypes){this.widgetTypes=widgetTypes,this.widgets={},this.$widgetManagerBtn=$("#widgetManagerBtn"),this.addListener(this.$widgetManagerBtn,"click","showWidgetManager"),Garnish.$doc.ready($.proxy((function(){this.$grid=$("#dashboard-grid"),this.grid=this.$grid.data("grid"),$("#newwidgetmenubtn").data("menubtn").menu.on("optionselect",$.proxy(this,"handleNewWidgetOptionSelect"))}),this))},getTypeInfo:function(type,property,defaultValue){return property?void 0===this.widgetTypes[type][property]?defaultValue:this.widgetTypes[type][property]:this.widgetTypes[type]},handleNewWidgetOptionSelect:function handleNewWidgetOptionSelect(e){var $option=$(e.selectedOption),type=$option.data("type"),settingsNamespace="newwidget"+Math.floor(1e9*Math.random())+"-settings",settingsHtml=this.getTypeInfo(type,"settingsHtml","").replace(/__NAMESPACE__/g,settingsNamespace),settingsJs=this.getTypeInfo(type,"settingsJs","").replace(/__NAMESPACE__/g,settingsNamespace),$gridItem=$('<div class="item" data-colspan="1" style="display: block">'),$container=$("<div/>",{class:"widget new loading-new scaleout","data-type":type}).addClass(type.toLowerCase()).append($("<div/>",{class:"front"}).append($("<div/>",{class:"pane"}).append($("<div/>",{class:"spinner body-loading"})).append($("<div/>",{class:"widget-heading"}).append("<h2/>").append("<h5/>")).append($("<div/>",{class:"body"})).append($("<div/>",{class:"settings icon hidden"})))).append($("<div/>",{class:"back"}).append($("<form/>",{class:"pane"}).append($("<input/>",{type:"hidden",name:"type",value:type})).append($("<input/>",{type:"hidden",name:"settingsNamespace",value:settingsNamespace})).append($("<h2/>",{text:Craft.t("app","{type} Settings",{type:$option.data("name")})})).append($("<div/>",{class:"settings"})).append("<hr/>").append($("<div/>",{class:"buttons clearafter"}).append($("<button/>",{type:"submit",class:"btn submit",text:Craft.t("app","Save")})).append($("<button/>",{type:"button",class:"btn",text:Craft.t("app","Cancel")})).append($("<div/>",{class:"spinner hidden"}))))).appendTo($gridItem);settingsHtml?($container.addClass("flipped"),$container.children(".front").addClass("hidden")):($container.addClass("loading"),$container.children(".back").addClass("hidden"));var widget=new Craft.Widget($container,settingsHtml.replace(/__NAMESPACE__/g,settingsNamespace),(function(){eval(settingsJs)}));if(this.grid.$items.length?$gridItem.insertAfter(this.grid.$items.last()):$gridItem.prependTo(this.grid.$container),this.grid.addItems($gridItem),Garnish.scrollContainerToElement($gridItem),$container.removeClass("scaleout"),!settingsHtml){var data={type:type};Craft.postActionRequest("dashboard/create-widget",data,(function(response,textStatus){"success"===textStatus&&response.success?($container.removeClass("loading"),widget.update(response)):widget.destroy()}))}},showWidgetManager:function(){if(this.widgetManager)this.widgetManager.show();else{for(var $widgets=this.$grid.find("> .item > .widget"),$form=$('<form method="post" accept-charset="UTF-8"><input type="hidden" name="action" value="widgets/save-widget"/></form>').appendTo(Garnish.$bod),$noWidgets=$('<p id="nowidgets"'+($widgets.length?' class="hidden"':"")+">"+Craft.t("app","You don’t have any widgets yet.")+"</p>").appendTo($form),$table=$('<table class="data'+($widgets.length?"":" hidden")+'"/>').appendTo($form),$tbody=$("<tbody/>").appendTo($table),i=0;i<$widgets.length;i++){var widget=$widgets.eq(i).data("widget");widget&&widget.id&&widget.getManagerRow().appendTo($tbody)}this.widgetManager=new Garnish.HUD(this.$widgetManagerBtn,$form,{hudClass:"hud widgetmanagerhud",onShow:$.proxy((function(){this.$widgetManagerBtn.addClass("active")}),this),onHide:$.proxy((function(){this.$widgetManagerBtn.removeClass("active")}),this)}),this.widgetAdminTable=new Craft.AdminTable({tableSelector:$table,noObjectsSelector:$noWidgets,sortable:!0,reorderAction:"dashboard/reorder-user-widgets",deleteAction:"dashboard/delete-user-widget",onReorderItems:$.proxy((function(ids){for(var lastWidget=null,i=0;i<ids.length;i++){var widget=this.widgets[ids[i]];lastWidget?widget.$gridItem.insertAfter(lastWidget.$gridItem):widget.$gridItem.prependTo(this.$grid),lastWidget=widget}this.grid.resetItemOrder()}),this),onDeleteItem:$.proxy((function(id){this.widgets[id].destroy()}),this)})}}}),Craft.Widget=Garnish.Base.extend({$container:null,$gridItem:null,$front:null,$settingsBtn:null,$title:null,$subtitle:null,$heading:null,$bodyContainer:null,$back:null,$settingsForm:null,$settingsContainer:null,$settingsSpinner:null,$settingsErrorList:null,id:null,type:null,title:null,subtitle:null,totalCols:null,settingsHtml:null,initSettingsFn:null,showingSettings:!1,colspanPicker:null,init:function(container,settingsHtml,initSettingsFn){this.$container=$(container),this.$gridItem=this.$container.parent(),this.$container.data("widget",this),this.id=this.$container.data("id"),this.type=this.$container.data("type"),this.title=this.$container.data("title"),this.id&&(window.dashboard.widgets[this.id]=this),this.$front=this.$container.children(".front"),this.$settingsBtn=this.$front.find("> .pane > .icon.settings"),this.$heading=this.$front.find("> .pane > .widget-heading"),this.$title=this.$heading.find("> h2"),this.$subtitle=this.$heading.find("> h5"),this.$bodyContainer=this.$front.find("> .pane > .body"),this.setSettingsHtml(settingsHtml,initSettingsFn),this.$container.hasClass("flipped")?(this.initBackUi(),this.refreshSettings(),this.onShowBack()):this.onShowFront(),this.addListener(this.$settingsBtn,"click","showSettings")},initBackUi:function(){this.$back=this.$container.children(".back"),this.$settingsForm=this.$back.children("form"),this.$settingsContainer=this.$settingsForm.children(".settings");var $btnsContainer=this.$settingsForm.children(".buttons");this.$settingsSpinner=$btnsContainer.children(".spinner"),this.addListener($btnsContainer.children(".btn:nth-child(2)"),"click","cancelSettings"),this.addListener(this.$settingsForm,"submit","saveSettings")},getColspan:function(){return this.$gridItem.data("colspan")},setColspan:function(colspan){this.$gridItem.data("colspan",colspan),window.dashboard.grid.refreshCols(!0)},getTypeInfo:function(property,defaultValue){return window.dashboard.getTypeInfo(this.type,property,defaultValue)},setSettingsHtml:function(settingsHtml,initSettingsFn){this.settingsHtml=settingsHtml,this.initSettingsFn=initSettingsFn,this.settingsHtml?this.$settingsBtn.removeClass("hidden"):this.$settingsBtn.addClass("hidden")},refreshSettings:function(){this.$settingsContainer.html(this.settingsHtml),Garnish.requestAnimationFrame($.proxy((function(){Craft.initUiElements(this.$settingsContainer),this.initSettingsFn()}),this))},showSettings:function(){var _this=this;this.$back||this.initBackUi(),this.refreshSettings(),this.$back.removeClass("hidden"),Garnish.requestAnimationFrame((function(){_this.$container.addClass("flipped").velocity({height:_this.$back.height()},{complete:$.proxy(_this,"onShowBack")})}))},hideSettings:function(){var _this2=this;this.$front.removeClass("hidden"),Garnish.requestAnimationFrame((function(){_this2.$container.removeClass("flipped").velocity({height:_this2.$front.height()},{complete:$.proxy(_this2,"onShowFront")})}))},saveSettings:function(e){e.preventDefault(),this.$settingsSpinner.removeClass("hidden");var action=this.$container.hasClass("new")?"dashboard/create-widget":"dashboard/save-widget-settings",data=this.$settingsForm.serialize();Craft.postActionRequest(action,data,$.proxy((function(response,textStatus){this.$settingsSpinner.addClass("hidden"),"success"===textStatus&&(this.$settingsErrorList&&(this.$settingsErrorList.remove(),this.$settingsErrorList=null),response.success?(Craft.cp.displayNotice(Craft.t("app","Widget saved.")),response.info?(this.update(response),this.hideSettings()):this.destroy()):(Craft.cp.displayError(Craft.t("app","Couldn’t save widget.")),response.errors&&(this.$settingsErrorList=Craft.ui.createErrorList(response.errors).insertAfter(this.$settingsContainer))))}),this))},update:function update(response){this.title=response.info.title,this.subtitle=response.info.subtitle,this.$container.hasClass("new")?(this.id=response.info.id,this.$container.attr("id","widget"+this.id).removeClass("new loading-new"),this.$settingsForm&&this.$settingsForm.prepend('<input type="hidden" name="widgetId" value="'+this.id+'"/>'),window.dashboard.widgets[this.id]=this,window.dashboard.widgetAdminTable&&window.dashboard.widgetAdminTable.addRow(this.getManagerRow())):window.dashboard.widgetAdminTable&&window.dashboard.widgetAdminTable.$tbody.children('[data-id="'+this.id+'"]:first').children("td:nth-child(2)").html(this.getManagerRowLabel()),this.title||this.subtitle?(this.title?this.$title.text(this.title):this.$title.remove(),this.subtitle?this.$subtitle.text(this.subtitle):this.$subtitle.remove()):this.$heading.remove(),this.$bodyContainer.html(response.info.bodyHtml),response.info.colspan!=this.getColspan()&&(this.setColspan(response.info.colspan),Garnish.scrollContainerToElement(this.$gridItem)),Craft.initUiElements(this.$bodyContainer),Craft.appendHeadHtml(response.headHtml),Craft.appendFootHtml(response.footHtml),this.setSettingsHtml(response.info.settingsHtml,(function(){eval(response.info.settingsJs)}))},cancelSettings:function(){this.id?this.hideSettings():this.destroy()},onShowFront:function(){this.showingSettings=!1,this.removeListener(this.$back,"resize"),this.addListener(this.$front,"resize","updateContainerHeight"),this.$back&&this.$back.addClass("hidden")},onShowBack:function(){this.showingSettings=!0,this.removeListener(this.$front,"resize"),this.addListener(this.$back,"resize","updateContainerHeight"),this.$front.addClass("hidden"),setTimeout($.proxy((function(){this.$settingsForm.find(":focusable:first").trigger("focus")}),this),1)},updateContainerHeight:function(){this.$container.height((this.showingSettings?this.$back:this.$front).height())},getManagerRow:function(){var _this3=this,$row=$('<tr data-id="'+this.id+'" data-name="'+Craft.escapeHtml(this.title)+'"><td class="widgetmanagerhud-icon">'+this.getTypeInfo("iconSvg")+"</td><td>"+this.getManagerRowLabel()+'</td><td class="widgetmanagerhud-col-colspan-picker thin"></td><td class="widgetmanagerhud-col-move thin"><a class="move icon" title="'+Craft.t("app","Reorder")+'" role="button"></a></td><td class="thin"><a class="delete icon" title="'+Craft.t("app","Delete")+'" role="button"></a></td></tr>');return this.colspanPicker=new Craft.SlidePicker(this.getColspan(),{min:1,max:function(){return window.dashboard.grid.totalCols},step:1,valueLabel:function(colspan){return Craft.t("app","{num, number} {num, plural, =1{column} other{columns}}",{num:colspan})},onChange:function(colspan){_this3.setColspan(colspan),window.dashboard.grid.refreshCols(!0);var data={id:_this3.id,colspan:colspan};Craft.postActionRequest("dashboard/change-widget-colspan",data,(function(response,textStatus){"success"===textStatus&&response.success?Craft.cp.displayNotice(Craft.t("app","Widget saved.")):Craft.cp.displayError(Craft.t("app","Couldn’t save widget."))}))}}),this.colspanPicker.$container.appendTo($row.find("> td.widgetmanagerhud-col-colspan-picker")),window.dashboard.grid.on("refreshCols",(function(){_this3.colspanPicker.refresh()})),$row},getManagerRowLabel:function(){var typeName=this.getTypeInfo("name");return Craft.escapeHtml(this.title)+(this.title!==typeName?' <span class="light">('+typeName+")</span>":"")},destroy:function(){delete window.dashboard.widgets[this.id],this.$container.addClass("scaleout"),this.base(),setTimeout($.proxy((function(){window.dashboard.grid.removeItems(this.$gridItem),this.$gridItem.remove()}),this),200)}})}(jQuery)},function(module,exports,__webpack_require__){var content=__webpack_require__(2);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);(0,__webpack_require__(3).default)("14e64e4e",content,!0,{})},function(module,exports,__webpack_require__){},function(module,__webpack_exports__,__webpack_require__){"use strict";function listToStyles(parentId,list){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=item[0],part={id:parentId+":"+i,css:item[1],media:item[2],sourceMap:item[3]};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return addStylesClient}));var hasDocument="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!hasDocument)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var stylesInDom={},head=hasDocument&&(document.head||document.getElementsByTagName("head")[0]),singletonElement=null,singletonCounter=0,isProduction=!1,noop=function(){},options=null,isOldIE="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function addStylesClient(parentId,list,_isProduction,_options){isProduction=_isProduction,options=_options||{};var styles=listToStyles(parentId,list);return addStylesToDom(styles),function(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i];(domStyle=stylesInDom[item.id]).refs--,mayRemove.push(domStyle)}newList?addStylesToDom(styles=listToStyles(parentId,newList)):styles=[];for(i=0;i<mayRemove.length;i++){var domStyle;if(0===(domStyle=mayRemove[i]).refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}}function addStylesToDom(styles){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j]));domStyle.parts.length>item.parts.length&&(domStyle.parts.length=item.parts.length)}else{var parts=[];for(j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j]));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function createStyleElement(){var styleElement=document.createElement("style");return styleElement.type="text/css",head.appendChild(styleElement),styleElement}function addStyle(obj){var update,remove,styleElement=document.querySelector('style[data-vue-ssr-id~="'+obj.id+'"]');if(styleElement){if(isProduction)return noop;styleElement.parentNode.removeChild(styleElement)}if(isOldIE){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement()),update=applyToSingletonTag.bind(null,styleElement,styleIndex,!1),remove=applyToSingletonTag.bind(null,styleElement,styleIndex,!0)}else styleElement=createStyleElement(),update=applyToTag.bind(null,styleElement),remove=function(){styleElement.parentNode.removeChild(styleElement)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet)styleElement.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=styleElement.childNodes;childNodes[index]&&styleElement.removeChild(childNodes[index]),childNodes.length?styleElement.insertBefore(cssNode,childNodes[index]):styleElement.appendChild(cssNode)}}function applyToTag(styleElement,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media&&styleElement.setAttribute("media",media),options.ssrId&&styleElement.setAttribute("data-vue-ssr-id",obj.id),sourceMap&&(css+="\n/*# sourceURL="+sourceMap.sources[0]+" */",css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"),styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}}]);
//# sourceMappingURL=Dashboard.min.js.map
!function(t){Craft.PluginStoreOauthCallback=Garnish.Base.extend({$graphic:null,$status:null,errorDetails:null,data:null,settings:null,init:function(s){if(this.setSettings(s),this.$graphic=t("#graphic"),this.$status=t("#status"),this.settings.error){var e=this.settings.message?this.settings.message:this.settings.error;this.$status.html(e),setTimeout(t.proxy((function(){window.location=this.settings.redirectUrl}),this),1e3)}else setTimeout(t.proxy((function(){this.postActionRequest()}),this),500)},postActionRequest:function(){var s=window.location.hash.substr(1),e=t.parseFragmentString(s);Craft.postActionRequest("plugin-store/save-token",e,t.proxy((function(s,e,r){"success"==e?s.error?this.showError(s.error):(this.updateStatus("<p>"+Craft.t("app","Connected!")+"</p>"),this.$graphic.addClass("success"),setTimeout(t.proxy((function(){void 0!==this.settings.redirectUrl?window.location=this.settings.redirectUrl:window.location=Craft.getCpUrl("plugin-store")}),this),500)):this.showFatalError(r)}),this))},showFatalError:function(t){this.$graphic.addClass("error");var s="<p>"+Craft.t("app","A fatal error has occurred:")+'</p><div id="error" class="code"><p><strong class="code">'+Craft.t("app","Status:")+"</strong> "+Craft.escapeHtml(t.statusText)+'</p><p><strong class="code">'+Craft.t("app","Response:")+"</strong> "+Craft.escapeHtml(t.responseText)+'</p></div><a class="btn submit big" href="mailto:support@craftcms.com?subject='+encodeURIComponent("Craft update failure")+"&body="+encodeURIComponent("Describe what happened here.\n\n-----------------------------------------------------------\n\nStatus: "+t.statusText+"\n\nResponse: "+t.responseText)+'">'+Craft.t("app","Send for help")+"</a>";this.updateStatus(s)},updateStatus:function(t){this.$status.html(t)},showError:function(s){this.$graphic.addClass("error"),this.updateStatus("<p>"+s+"</p>");var e=t('<div id="junction-buttons"/>').appendTo(this.$status);$cancelBtn=t("<a/>",{class:"btn big",href:Craft.getCpUrl("plugin-store"),text:"Cancel"}).appendTo(e),$retryBtn=t("<a/>",{class:"btn big",href:Craft.getActionUrl("plugin-store/connect"),text:"Try again"}).appendTo(e)}})}(jQuery);
//# sourceMappingURL=PluginStoreOauthCallback.min.js.map

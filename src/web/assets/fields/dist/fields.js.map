{"version":3,"file":"fields.js","mappings":"YAAA,IAAWA,EAGLC,EAHKD,EA6IRE,OA1IGD,EAAcE,QAAQC,KAAKC,OAAO,CACpCC,QAAS,KACTC,eAAgB,KAEhBC,KAAM,WAAY,WAChBC,KAAKH,QAAUN,EAAE,WACjBS,KAAKF,eAAiBE,KAAKH,QAAQI,KAAK,eACxCD,KAAKE,YAAYX,EAAE,gBAAiB,WAAY,eAEhD,IAAIY,EAAoBZ,EAAE,qBAEtBY,EAAkBC,SACND,EAAkBE,KAAK,WAE7BC,SAASC,eAAiB,SAACC,GAGjC,OAFajB,EAAEiB,GAAMH,KAAK,WAGxB,IAAK,SACH,EAAKI,sBACL,MAEF,IAAK,SACH,EAAKC,sBAIV,EAEJ,EAEDC,YAAa,WAAY,WACnBC,EAAOZ,KAAKa,mBAAmB,IAEnC,GAAID,EAAM,CACR,IAAIP,EAAO,CACTO,KAAMA,GAGRE,MAAMC,kBAAkB,OAAQ,oBAAqB,CAACV,KAAAA,IACnDW,MAAK,SAACC,GACLC,SAASC,KAAOL,MAAMM,OACpB,mBAAqBH,EAASZ,KAAKgB,MAAMC,GAE5C,IALH,OAMS,YAAgB,IAAdL,EAAc,EAAdA,SACP,GAAIA,EAASZ,KAAKkB,OAAQ,CACxB,IAAIA,EAAS,EAAKC,cAAcP,EAASZ,KAAKkB,QAC9CE,MACEX,MAAMY,EAAE,MAAO,+BACb,OACAH,EAAOI,KAAK,MAEjB,MACCb,MAAMc,GAAGC,cAEZ,GACJ,CACF,EAEDpB,oBAAqB,WAAY,WAC3BqB,EAAU9B,KAAKF,eAAeiC,OAChCC,EAAUhC,KAAKa,mBAAmBiB,GAEpC,GAAIE,GAAWA,IAAYF,EAAS,CAClC,IAAIzB,EAAO,CACTiB,GAAItB,KAAKF,eAAeO,KAAK,MAC7BO,KAAMoB,GAGRlB,MAAMC,kBAAkB,OAAQ,oBAAqB,CAACV,KAAAA,IACnDW,MAAK,SAACC,GACL,EAAKnB,eAAeiC,KAAKd,EAASZ,KAAKgB,MAAMT,MAC7CE,MAAMc,GAAGK,eAAenB,MAAMY,EAAE,MAAO,kBACxC,IAJH,OAKS,YAAgB,IAAdT,EAAc,EAAdA,SACP,GAAIA,EAASZ,KAAKkB,OAAQ,CACxB,IAAIA,EAAS,EAAKC,cAAcP,EAASZ,KAAKkB,QAC9CE,MACEX,MAAMY,EAAE,MAAO,+BACb,OACAH,EAAOI,KAAK,MAEjB,MACCb,MAAMc,GAAGC,cAEZ,GACJ,CACF,EAEDhB,mBAAoB,SAAUiB,GAC5B,OAAOI,OACLpB,MAAMY,EAAE,MAAO,uCACfI,EAEH,EAEDpB,oBAAqB,WACnB,GACEyB,QACErB,MAAMY,EACJ,MACA,mEAGJ,CACA,IAAIrB,EAAO,CACTiB,GAAItB,KAAKF,eAAeO,KAAK,OAG/BS,MAAMC,kBAAkB,OAAQ,sBAAuB,CAACV,KAAAA,IACrDW,MAAK,SAACC,GACLC,SAASC,KAAOL,MAAMM,OAAO,kBAC9B,IAHH,OAIS,YAAgB,EAAdH,SACPH,MAAMc,GAAGC,cACV,GACJ,CACF,EAEDL,cAAe,SAAUY,GACvB,IAAIb,EAAS,GAEb,IAAK,IAAIc,KAAaD,EACfA,EAAeE,eAAeD,KAInCd,EAASA,EAAOgB,OAAOH,EAAeC,KAGxC,OAAOd,CACR,IAGH7B,QAAQ8C,KAAKC,OAAM,WACjB3B,MAAMtB,YAAc,IAAIA,CACzB,G","sources":["webpack:///./fields.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  var FieldsAdmin = Garnish.Base.extend({\n    $groups: null,\n    $selectedGroup: null,\n\n    init: function () {\n      this.$groups = $('#groups');\n      this.$selectedGroup = this.$groups.find('a.sel:first');\n      this.addListener($('#newgroupbtn'), 'activate', 'addNewGroup');\n\n      var $groupSettingsBtn = $('#groupsettingsbtn');\n\n      if ($groupSettingsBtn.length) {\n        var menuBtn = $groupSettingsBtn.data('menubtn');\n\n        menuBtn.settings.onOptionSelect = (elem) => {\n          var action = $(elem).data('action');\n\n          switch (action) {\n            case 'rename': {\n              this.renameSelectedGroup();\n              break;\n            }\n            case 'delete': {\n              this.deleteSelectedGroup();\n              break;\n            }\n          }\n        };\n      }\n    },\n\n    addNewGroup: function () {\n      var name = this.promptForGroupName('');\n\n      if (name) {\n        var data = {\n          name: name,\n        };\n\n        Craft.sendActionRequest('POST', 'fields/save-group', {data})\n          .then((response) => {\n            location.href = Craft.getUrl(\n              'settings/fields/' + response.data.group.id\n            );\n          })\n          .catch(({response}) => {\n            if (response.data.errors) {\n              var errors = this.flattenErrors(response.data.errors);\n              alert(\n                Craft.t('app', 'Could not create the group:') +\n                  '\\n\\n' +\n                  errors.join('\\n')\n              );\n            } else {\n              Craft.cp.displayError();\n            }\n          });\n      }\n    },\n\n    renameSelectedGroup: function () {\n      var oldName = this.$selectedGroup.text(),\n        newName = this.promptForGroupName(oldName);\n\n      if (newName && newName !== oldName) {\n        var data = {\n          id: this.$selectedGroup.data('id'),\n          name: newName,\n        };\n\n        Craft.sendActionRequest('POST', 'fields/save-group', {data})\n          .then((response) => {\n            this.$selectedGroup.text(response.data.group.name);\n            Craft.cp.displaySuccess(Craft.t('app', 'Group renamed.'));\n          })\n          .catch(({response}) => {\n            if (response.data.errors) {\n              var errors = this.flattenErrors(response.data.errors);\n              alert(\n                Craft.t('app', 'Could not rename the group:') +\n                  '\\n\\n' +\n                  errors.join('\\n')\n              );\n            } else {\n              Craft.cp.displayError();\n            }\n          });\n      }\n    },\n\n    promptForGroupName: function (oldName) {\n      return prompt(\n        Craft.t('app', 'What do you want to name the group?'),\n        oldName\n      );\n    },\n\n    deleteSelectedGroup: function () {\n      if (\n        confirm(\n          Craft.t(\n            'app',\n            'Are you sure you want to delete this group and all its fields?'\n          )\n        )\n      ) {\n        var data = {\n          id: this.$selectedGroup.data('id'),\n        };\n\n        Craft.sendActionRequest('POST', 'fields/delete-group', {data})\n          .then((response) => {\n            location.href = Craft.getUrl('settings/fields');\n          })\n          .catch(({response}) => {\n            Craft.cp.displayError();\n          });\n      }\n    },\n\n    flattenErrors: function (responseErrors) {\n      var errors = [];\n\n      for (var attribute in responseErrors) {\n        if (!responseErrors.hasOwnProperty(attribute)) {\n          continue;\n        }\n\n        errors = errors.concat(responseErrors[attribute]);\n      }\n\n      return errors;\n    },\n  });\n\n  Garnish.$doc.ready(function () {\n    Craft.FieldsAdmin = new FieldsAdmin();\n  });\n})(jQuery);\n"],"names":["$","FieldsAdmin","jQuery","Garnish","Base","extend","$groups","$selectedGroup","init","this","find","addListener","$groupSettingsBtn","length","data","settings","onOptionSelect","elem","renameSelectedGroup","deleteSelectedGroup","addNewGroup","name","promptForGroupName","Craft","sendActionRequest","then","response","location","href","getUrl","group","id","errors","flattenErrors","alert","t","join","cp","displayError","oldName","text","newName","displaySuccess","prompt","confirm","responseErrors","attribute","hasOwnProperty","concat","$doc","ready"],"sourceRoot":""}
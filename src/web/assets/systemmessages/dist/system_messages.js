!function(){var e={288:function(){},411:function(e,t,n){var s=n(288);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals),(0,n(673).Z)("8fde0d4c",s,!0,{})},673:function(e,t,n){"use strict";function s(e,t){for(var n=[],s={},a=0;a<t.length;a++){var r=t[a],i=r[0],o={id:e+":"+a,css:r[1],media:r[2],sourceMap:r[3]};s[i]?s[i].parts.push(o):n.push(s[i]={id:i,parts:[o]})}return n}n.d(t,{Z:function(){return p}});var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var r={},i=a&&(document.head||document.getElementsByTagName("head")[0]),o=null,u=0,l=!1,c=function(){},d=null,f="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,a){l=n,d=a||{};var i=s(e,t);return g(i),function(t){for(var n=[],a=0;a<i.length;a++){var o=i[a];(u=r[o.id]).refs--,n.push(u)}for(t?g(i=s(e,t)):i=[],a=0;a<n.length;a++){var u;if(0===(u=n[a]).refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete r[u.id]}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t],s=r[n.id];if(s){s.refs++;for(var a=0;a<s.parts.length;a++)s.parts[a](n.parts[a]);for(;a<n.parts.length;a++)s.parts.push(v(n.parts[a]));s.parts.length>n.parts.length&&(s.parts.length=n.parts.length)}else{var i=[];for(a=0;a<n.parts.length;a++)i.push(v(n.parts[a]));r[n.id]={id:n.id,refs:1,parts:i}}}}function m(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function v(e){var t,n,s=document.querySelector("style["+f+'~="'+e.id+'"]');if(s){if(l)return c;s.parentNode.removeChild(s)}if(h){var a=u++;s=o||(o=m()),t=y.bind(null,s,a,!1),n=y.bind(null,s,a,!0)}else s=m(),t=C.bind(null,s),n=function(){s.parentNode.removeChild(s)};return t(e),function(s){if(s){if(s.css===e.css&&s.media===e.media&&s.sourceMap===e.sourceMap)return;t(e=s)}else n()}}var $,b=($=[],function(e,t){return $[e]=t,$.filter(Boolean).join("\n")});function y(e,t,n,s){var a=n?"":s.css;if(e.styleSheet)e.styleSheet.cssText=b(t,a);else{var r=document.createTextNode(a),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}function C(e,t){var n=t.css,s=t.media,a=t.sourceMap;if(s&&e.setAttribute("media",s),d.ssrId&&e.setAttribute(f,t.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},t={};function n(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={id:s,exports:{}};return e[s](r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e,t,s,a;n(411),e=jQuery,t=Garnish.Base.extend({messages:null,init:function(){this.messages=[];for(var t=e("#messages").find(".message"),n=0;n<t.length;n++){var a=new s(t[n]);this.messages.push(a)}}}),s=Garnish.Base.extend({$container:null,key:null,$subject:null,$body:null,modal:null,init:function(t){this.$container=e(t),this.key=this.$container.attr("data-key"),this.$subject=this.$container.find(".subject:first"),this.$body=this.$container.find(".body:first"),this.addListener(this.$container,"click","edit")},edit:function(){this.modal?this.modal.show():this.modal=new a(this)},updateHtmlFromModal:function(){var e=this.modal.$subjectInput.val(),t=Craft.escapeHtml(this.modal.$bodyInput.val()).replace(/\n/g,"<br>");this.$subject.text(e),this.$body.html(t)}}),a=Garnish.Modal.extend({message:null,$languageSelect:null,$subjectInput:null,$bodyInput:null,$saveBtn:null,$cancelBtn:null,$spinner:null,loading:!1,init:function(e){this.message=e,this.base(null,{resizable:!0}),this.loadContainer()},loadContainer:function(t){var n=this,s={key:this.message.key,language:t};void 0!==Craft.csrfTokenName&&void 0!==Craft.csrfTokenValue&&(s[Craft.csrfTokenName]=Craft.csrfTokenValue),Craft.postActionRequest("system-messages/get-message-modal",s,(function(t,s){if("success"===s){if(n.$container)n.$container.html(t.body);else{var a=e('<form class="modal fitted message-settings" accept-charset="UTF-8">'+t.body+"</form>").appendTo(Garnish.$bod);n.setContainer(a),n.show()}n.$languageSelect=n.$container.find(".language:first > select"),n.$subjectInput=n.$container.find(".message-subject:first"),n.$bodyInput=n.$container.find(".message-body:first"),n.$saveBtn=n.$container.find(".submit:first"),n.$cancelBtn=n.$container.find(".cancel:first"),n.$spinner=n.$container.find(".spinner:first"),n.addListener(n.$languageSelect,"change","switchLanguage"),n.addListener(n.$container,"submit","saveMessage"),n.addListener(n.$cancelBtn,"click","cancel"),setTimeout((function(){n.$subjectInput.trigger("focus")}),100)}}))},switchLanguage:function(){this.loadContainer(this.$languageSelect.val())},saveMessage:function(e){var t=this;if(e.preventDefault(),!this.loading){var n={key:this.message.key,language:this.$languageSelect.length?this.$languageSelect.val():Craft.primarySiteLanguage,subject:this.$subjectInput.val(),body:this.$bodyInput.val()};if(this.$subjectInput.removeClass("error"),this.$bodyInput.removeClass("error"),!n.subject||!n.body)return n.subject||this.$subjectInput.addClass("error"),n.body||this.$bodyInput.addClass("error"),void Garnish.shake(this.$container);this.loading=!0,this.$saveBtn.addClass("active"),this.$spinner.show(),Craft.postActionRequest("system-messages/save-message",n,(function(e,s){t.$saveBtn.removeClass("active"),t.$spinner.hide(),t.loading=!1,"success"===s&&(e.success?(n.language===Craft.primarySiteLanguage&&t.message.updateHtmlFromModal(),t.hide(),Craft.cp.displayNotice(Craft.t("app","Message saved."))):Craft.cp.displayError())}))}},cancel:function(){this.hide(),this.message&&(this.message.modal=null)}}),new t}()}();
//# sourceMappingURL=system_messages.js.map
!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/",__webpack_require__(__webpack_require__.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var $;__webpack_require__(1);$=jQuery,Craft.Installer=Garnish.Base.extend({$bg:null,$screens:null,$dots:null,$currentScreen:null,$currentDot:null,$dbDriverInput:null,$dbPortInput:null,modal:null,currentScreen:null,loading:!1,init:function(){this.$bg=$("#bg"),this.$screens=$("#screens").children(),this.$dbDriverInput=$("#db-driver"),this.$dbPortInput=$("#db-port"),this.updateDbPortInput(),this.addListener(this.$screens.find("form"),"submit","handleScreenSubmit"),this.addListener(this.$screens.find(".btn.submit"),"activate","handleScreenSubmit"),this.addListener($("#beginbtn"),"activate","showModal"),this.addListener(this.$dbDriverInput,"change","updateDbPortInput"),new Craft.PasswordInput("#account-password")},showModal:function(){this.modal?this.modal.show():(this.modal=new Garnish.Modal($("#install-modal").removeClass("hidden"),{hideOnEsc:!1,shadeClass:""}),this.gotoScreen(1))},updateDbPortInput:function(){var driver=this.$dbDriverInput.val(),port=this.$dbPortInput.val(),defaultPort=Craft.Installer.defaultDbPorts[driver];this.$dbPortInput.attr("placeholder",defaultPort),port==defaultPort&&this.$dbPortInput.val("")},handleScreenSubmit:function(ev){ev.preventDefault();var inputs=this.getScreenInputNames(this.$currentScreen);inputs?this.validate(this.$currentScreen.attr("id"),inputs):this.gotoNextScreen()},getScreenInputNames:function($screen){var inputsStr=$screen.attr("data-inputs");return inputsStr?inputsStr.split(","):null},getInputData:function(what,inputs,includePrefix){for(var data={},i=0;i<inputs.length;i++){var input=inputs[i],$input=$("#"+what+"-"+input);data[(includePrefix?what+"-":"")+input]=Garnish.getInputPostVal($input)}return data},showInstallScreen:function(){for(var $screen,inputs,data={},i=1;i<this.$screens.length-1;i++)$screen=this.$screens.eq(i),inputs=this.getScreenInputNames($screen),$.extend(data,this.getInputData($screen.attr("id"),inputs,!0));Craft.postActionRequest("install/install",data,$.proxy(this,"allDone"),{complete:$.noop})},allDone:function(response,textStatus){$("#spinner").remove();var $h1=this.$currentScreen.find("h1:first");"success"===textStatus&&response.success?($h1.text(Craft.t("app","Craft is installed! ðŸŽ‰")),setTimeout((function(){window.location.href=Craft.getUrl(postCpLoginRedirect)}),1e3)):($h1.text("Install failed ðŸ˜ž"),$("<p/>",{text:"Please check your logs for more info."}).insertAfter($h1))},gotoNextScreen:function(){this.gotoScreen(this.currentScreen+1)},gotoScreen:function(i){if(1===i)this.$dots&&this.$dots.hide();else if(this.$dots)this.$dots.show();else{this.$dots=$();for(var j=0;j<this.$screens.length;j++)this.$dots=this.$dots.add($("<div/>").appendTo($("#dots")))}this.$currentScreen&&(this.$currentScreen.addClass("hidden"),this.$currentDot&&this.$currentDot.removeClass("sel")),this.currentScreen=i,this.$currentScreen=this.$screens.eq(i-1).removeClass("hidden"),this.$dots&&(this.$currentDot=this.$dots.eq(i-1).addClass("sel")),i===this.$screens.length?this.showInstallScreen():1!==i&&this.$currentScreen.find("input[type=text]:first").trigger("focus")},validate:function(what,inputs){if(!this.loading){this.loading=!0,this.$currentScreen.find(".input").removeClass("errors"),this.$currentScreen.find("ul.errors").remove();var $submitBtn=this.$currentScreen.find(".btn.submit");$submitBtn.addClass("sel loading");var action="install/validate-"+what,data=this.getInputData(what,inputs,!1);Craft.postActionRequest(action,data,$.proxy((function(response,textStatus){if(this.loading=!1,$submitBtn.removeClass("sel loading"),"success"===textStatus)if(response.validates)this.gotoNextScreen();else{var $errors=$("<ul/>",{class:"errors"}).insertBefore($("#"+what).find(".buttons"));for(var input in response.errors)if(response.errors.hasOwnProperty(input)){for(var i=0;i<response.errors[input].length;i++)$("<li>"+response.errors[input][i]+"</li>").appendTo($errors);var $input=$("#"+what+"-"+input+"-field").children(".input");$input.addClass("errors"),$.proxy((function($input){var $elements=$input.find("select,input");this.addListener($elements,"focus,blur,textchange,change",(function(){$input.removeClass("errors"),this.removeListener($elements,"focus,blur,textchange,change")}))}),this)($input)}Garnish.shake(this.$currentScreen)}}),this))}}},{defaultDbPorts:{mysql:3306,pgsql:5432}}),Garnish.$win.on("load",(function(){Craft.installer=new Craft.Installer}))},function(module,exports,__webpack_require__){var content=__webpack_require__(2);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);(0,__webpack_require__(3).default)("e86b0566",content,!0,{})},function(module,exports,__webpack_require__){},function(module,__webpack_exports__,__webpack_require__){"use strict";function listToStyles(parentId,list){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=item[0],part={id:parentId+":"+i,css:item[1],media:item[2],sourceMap:item[3]};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return addStylesClient}));var hasDocument="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!hasDocument)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var stylesInDom={},head=hasDocument&&(document.head||document.getElementsByTagName("head")[0]),singletonElement=null,singletonCounter=0,isProduction=!1,noop=function(){},options=null,isOldIE="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function addStylesClient(parentId,list,_isProduction,_options){isProduction=_isProduction,options=_options||{};var styles=listToStyles(parentId,list);return addStylesToDom(styles),function(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i];(domStyle=stylesInDom[item.id]).refs--,mayRemove.push(domStyle)}newList?addStylesToDom(styles=listToStyles(parentId,newList)):styles=[];for(i=0;i<mayRemove.length;i++){var domStyle;if(0===(domStyle=mayRemove[i]).refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}}function addStylesToDom(styles){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j]));domStyle.parts.length>item.parts.length&&(domStyle.parts.length=item.parts.length)}else{var parts=[];for(j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j]));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function createStyleElement(){var styleElement=document.createElement("style");return styleElement.type="text/css",head.appendChild(styleElement),styleElement}function addStyle(obj){var update,remove,styleElement=document.querySelector('style[data-vue-ssr-id~="'+obj.id+'"]');if(styleElement){if(isProduction)return noop;styleElement.parentNode.removeChild(styleElement)}if(isOldIE){var styleIndex=singletonCounter++;styleElement=singletonElement||(singletonElement=createStyleElement()),update=applyToSingletonTag.bind(null,styleElement,styleIndex,!1),remove=applyToSingletonTag.bind(null,styleElement,styleIndex,!0)}else styleElement=createStyleElement(),update=applyToTag.bind(null,styleElement),remove=function(){styleElement.parentNode.removeChild(styleElement)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(styleElement,index,remove,obj){var css=remove?"":obj.css;if(styleElement.styleSheet)styleElement.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=styleElement.childNodes;childNodes[index]&&styleElement.removeChild(childNodes[index]),childNodes.length?styleElement.insertBefore(cssNode,childNodes[index]):styleElement.appendChild(cssNode)}}function applyToTag(styleElement,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media&&styleElement.setAttribute("media",media),options.ssrId&&styleElement.setAttribute("data-vue-ssr-id",obj.id),sourceMap&&(css+="\n/*# sourceURL="+sourceMap.sources[0]+" */",css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"),styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}}]);
//# sourceMappingURL=install.min.js.map